<!DOCTYPE html>
<html lang="uk">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nazar Birthday ORV</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.3.1"></script>
  <link rel="stylesheet" href="Naz.css">
</head>

<body>
  <div id="scene">
    <canvas id="confetti"></canvas>
    <div class="overlay"></div>
    <img id="hero" src="Joonjuk.png" alt="Ю Джун Хек">
    <div class="flash"></div>
    <div class="slash-line" id="slashLine"></div>
    <div class="age" id="age">16</div>
    <div class="birthday-wish">З Днем Народження, Назар!</div>
  </div>

  <button id="startButton">Little Surprise!</button>

  <audio id="swordSound" src="taking-out-knife-217793.mp3" preload="auto"></audio>

  <script>
    const btn = document.getElementById("startButton");
    const overlay = document.querySelector(".overlay");
    const flash = document.querySelector(".flash");
    const hero = document.getElementById("hero");
    const wish = document.querySelector(".birthday-wish");
    const swordSound = document.getElementById("swordSound");
    const slashLine = document.getElementById("slashLine");

    btn.addEventListener("click", () => {
      btn.style.display = "none";
      const tl = gsap.timeline();

      // Темрява
      tl.to(overlay, { opacity: 1, duration: 0.5 });

      // Звук і поява героя + розріз
      tl.add(() => swordSound.play(), "<");
      tl.to(hero, { opacity: 0.25, duration: 0.1, ease: "power2.in" }, "<0.1");
      tl.to(hero, { opacity: 0, duration: 0.1, ease: "power2.out" }, ">0.1");

      // Світлова лінія
      tl.to(slashLine, { opacity: 1, duration: 0.05, ease: "power1.in" }, "<");
      tl.to(slashLine, { x: "50%", opacity: 0, duration: 0.25, ease: "power4.out" }, "<0.05");

      // Спалах одноразово
      tl.to(flash, { opacity: 1, duration: 0.1 }, "<");
      tl.to(flash, { opacity: 0, duration: 0.25 });

      // Розріз "16"
      tl.add(() => {
        const oldAge = document.getElementById("age");
        oldAge.remove(); // прибираємо старий елемент

        const left = document.createElement("div");
        const right = document.createElement("div");
        left.classList.add("age");
        right.classList.add("age");
        left.textContent = "16";
        right.textContent = "16";
        document.body.appendChild(left);
        document.body.appendChild(right);

        gsap.set(left, { clipPath: "polygon(0 0, 100% 0, 100% 50%, 0 50%)" });
        gsap.set(right, { clipPath: "polygon(0 50%, 100% 50%, 100% 100%, 0 100%)" });

        gsap.to(left, { y: -100, rotate: -8, opacity: 0, duration: 0.6, ease: "power3.in" });
        gsap.to(right, { y: 120, rotate: 8, opacity: 0, duration: 0.6, ease: "power3.in" });

        setTimeout(() => {
          left.remove();
          right.remove();

          // Створюємо новий елемент для "17"
          const newAge = document.createElement("div");
          newAge.classList.add("age");
          newAge.textContent = "17";
          document.body.appendChild(newAge);

          gsap.fromTo(newAge, { scale: 3, opacity: 0 }, { scale: 1, opacity: 1, duration: 1, ease: "back.out(2)" });

          // Конфеті + побажання
          confetti({ particleCount: 150, spread: 180, origin: { y: 0.6 } });
          gsap.to(wish, { opacity: 1, duration: 1 });
        }, 650); // після завершення анімації половинок
      }, "<0.05");

      // Тремтіння сцени
      tl.to("#scene", { x: 20, yoyo: true, repeat: 5, duration: 0.05, ease: "power1.inOut" }, "<");
    });
  </script>
</body>

</html>
